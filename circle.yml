deployment:
  production:
    commands:
      - heroku maintenance:on --app supportroo
      - heroku scale worker=0 --app supportroo
      - git push git@heroku.com:supportroo.git $CIRCLE_SHA1:refs/heads/master
      - heroku run rake db:migrate --app supportroo:
      - heroku scale worker=x --app supportroo
      - heroku maintenance:off --app supportroo

  staging:
    commands:
      - heroku maintenance:on --app supportroo-staging
      - heroku scale worker=0 --app supportroo-staging
      - git push git@heroku.com:supportroo-staging.git $CIRCLE_SHA1:refs/heads/staging
      - heroku run rake db:migrate --app supportroo-staging
      - heroku scale worker=x --app supportroo-staging
      - heroku maintenance:off --app supportroo-staging